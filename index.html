<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CONVERSOR DE HTML</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>

body {
font-family: 'Arial', sans-serif;
margin: 0;
padding: 0;
color: #333;
position: relative;
background-color: #f0f4f8;
}

body::before {
content: '';
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-image: url('https://www.ufsm.br/app/uploads/sites/344/2024/11/AN1_8732-2.jpg');
background-size: cover;
background-position: center;
background-repeat: no-repeat;
z-index: -1;
opacity: 0.9; 
}

.container {
max-width: 1050px;
margin: 50px auto;
background-color: rgba(64, 63, 59, 0.5); 
padding: 30px;
border-radius: 10px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
transition: all 0.3s ease;
}

.container.with-sidebar {
margin-right: 350px; /* Espaço para a barra lateral */
}

.header {
text-align: center;
margin-bottom: 35px; 
}

.logo {
width: 300px;
height: 200px;
object-fit: contain;
margin-bottom: 15px;
}

h1 {
text-align: center;
font-size: 40px;
font-weight: bold;
text-align: center;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); 
color: #c99436;
}

h2 {
text-align: center;
font-size: 25px;
text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
font-family: 'Arial', sans-serif;
padding: 10px;
color: #0168A6;
}

h3 {
text-align: center;
font-size: 15px;
font-weight: bold;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
padding: 15px;
color: #FAFAFA;
}

h4 {
text-align: center;
color: #000;
}
.editor {
width: 100%;
height: 350px;
padding: 10px;
margin-bottom: 20px;
font-size: 14px;
border: 1px solid #ddd;
border-radius: 12px;
resize: vertical;
background-color: #f5f7fa;
text-align: justify;
outline: none;
overflow: auto;
word-wrap: break-word;
}

.toolbar-container {
display: flex;
flex-wrap: wrap;
align-items: center;
margin-bottom: 20px;
gap: 3px; 
}

.toolbar, .alignment-bar, .indent-bar, .color-bar {
display: flex;
gap: 5px; 
}

.toolbar button, .alignment-bar button, .indent-bar button, .color-bar button, .manual-button {
padding: 10px 15px;
font-size: 10px;
border: 1px solid #000;
border-radius: 4px;
cursor: pointer;
background-color: #E9F9FF;
color: black;
transition: background-color 0.3s ease;
height: 30px; 
}

.toolbar button:hover, .alignment-bar button:hover, .indent-bar button:hover, .color-bar button:hover, .manual-button:hover {
background-color: #3498db;
}

.separator {
margin: 0 10px;
color: #ccc;
}

.output-container {
margin-top: 20px;
}

.code-output {
border: 1px solid #ddd;
padding: 12px;border-radius: 10px;
background-color: #fafafa;
min-height: 200px;
font-family: monospace;
overflow-y: auto;
white-space: pre-wrap;
height: 400px; 
}

.button-container {
text-align: center;
margin-top: 0px;
}

.button-container button {
padding: 15px 20px;
font-size: 16px;
border: none;
border-radius: 10px;
cursor: pointer;
background-color: #E98C42;
color: white;
transition: background-color 0.3s ease;
}

.button-container button:hover {
background-color: #218838;
}

.clear-button {
background-color: #dc3545;
}

.clear-button:hover {
background-color: #c82333;
}

.ementa-button {
background-color: #EE8630;
color: black;
font-weight: bold;
}

.ementa-button:hover {
background-color: #d77a29;
}

.separator {
margin: 0 5px;
color: #ccc;
}

.centered-image {
display: flex;
justify-content: center;
align-items: center;
margin-top: 10px;
text-align: center;
}

.centered-image img {
width: 1.71cm;
height: 1.83cm;
}

.header-text {
text-align: center;
font-size: 14px;
color: #3938FF;
margin-top: 10px;
}

.subheader-text {
text-align: center;
font-size: 12px;
color: #00B0E0;
margin-top: 5px;
}

.normal-text {
color: black;
}

.centered-cursor {
text-align: center;
color: black;
}

.color-bar {
display: flex;
justify-content: center;
gap: 10px;
margin-bottom: 10px; 
}

/* Estilos para o Manual no Sidebar */
.sidebar {
position: fixed;
top: 0;
right: -350px; /* Inicialmente escondido */
width: 330px;
height: 100%;
background-color: rgba(255, 255, 255, 0.95);
overflow-y: auto;
z-index: 1000;
padding: 20px;
box-shadow: -5px 0 15px rgba(0,0,0,0.1);
transition: right 0.3s ease;
}

.sidebar.active {
right: 0;
}

.sidebar-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
border-bottom: 2px solid #0168A6;
padding-bottom: 10px;
}

.sidebar-title {
color: #0168A6;
font-size: 20px;
margin: 0;
}

.close-sidebar {
color: #aaa;
font-size: 24px;
font-weight: bold;
cursor: pointer;
}

.close-sidebar:hover {
color: #333;
}

#manualContent {
line-height: 1.6;
}

#manualContent h1 {
color: #0168A6;
text-align: left;
font-size: 20px;
margin-top: 20px;
margin-bottom: 15px;
text-shadow: none;
}

#manualContent h2 {
color: #E98C42;
text-align: left;
font-size: 18px;
margin-top: 15px;
text-shadow: none;
}

#manualContent h3 {
color: #333;
text-align: left;
font-size: 16px;
margin-top: 10px;
text-shadow: none;
}

#manualContent p, #manualContent li {
color: #333;
margin-bottom: 8px;
text-align: left;
font-size: 14px;
}

#manualContent ol, #manualContent ul {
padding-left: 20px;
margin-top: 5px;
margin-bottom: 10px;
}

/* Botão de manual com destaque */
.manual-button {
background-color: #0168A6;
color: white;
font-weight: bold;
height: auto;
}

.manual-button:hover {
background-color: #014e7d;
}

/* Destaque para os passos */
.step-highlight {
background-color: #fffacd;
padding: 5px;
border-radius: 3px;
border-left: 3px solid #E98C42;
}

</style>
</head>
<body>

<div id="mainContainer" class="container">
<div class="header">
<img src="https://www.ufsm.br/app/uploads/sites/344/2024/11/Logo_Proplan_UFSM_png.png" alt="Logo" class="logo">

<h1>HYPERTEXT MARKUP LANGUAGE CONVERSOR</h1> 
</div>

<h2>FORMATAÇÃO</h2> 

<!-- Botão do Manual -->
<div style="text-align: right; margin-bottom: 10px;">
    <button class="manual-button" onclick="toggleManual()"><i class="fas fa-book"></i> MANUAL DE INSTRUÇÕES</button>
</div>

<div class="toolbar-container">
<!-- Separador -->
<div class="separator">|</div>

<!-- Botão de Inserir Cabeçalho -->
<div class="toolbar">
<button onclick="insertCabecalho()">Inserir Cabeçalho</button>
</div>

<!-- Padrão Ementa -->
<div class="toolbar">
<button onclick="applyEmenta()" class="ementa-button">Padrão Ementa</button>
</div>

<!-- Botão de Inserir Rodapé -->
<div class="toolbar">
<button onclick="insertRodape()">Rodapé</button>
</div>

<!-- Separador -->
<div class="separator">|</div>

<!-- Barra de Alinhamento -->
<div class="alignment-bar">
<button onclick="applyAlignment('left')"><i class="fas fa-align-left"></i></button>
<button onclick="applyAlignment('center')"><i class="fas fa-align-center"></i></button>
<button onclick="applyAlignment('right')"><i class="fas fa-align-right"></i></button>
<button onclick="applyAlignment('justify')"><i class="fas fa-align-justify"></i></button>
</div>

<!-- Separador -->
<div class="separator">|</div>

<!-- Barra de Ferramentas -->
<div class="toolbar">
<button onclick="applyTag('bold')"><i class="fas fa-bold"></i></button>
<button onclick="applyTag('italic')"><i class="fas fa-italic"></i></button>
<button onclick="applyTag('strikethrough')"><i class="fas fa-strikethrough"></i></button>
<button onclick="applyTag('underline')"><i class="fas fa-underline"></i></button>
<button onclick="applyTag('subscript')"><i class="fas fa-subscript"></i></button>
<button onclick="applyTag('superscript')"><i class="fas fa-superscript"></i></button>

<!-- Separador -->
<div class="separator">|</div>

<!-- Barra de Hiperlink -->
<div class="toolbar">
<button onclick="applyTag('link')"><i class="fas fa-link"></i></button>
</div>
</div>

<!-- Separador -->
<div class="separator">|</div>

<!-- Barra de Recuo -->
<div class="indent-bar">
<button onclick="applyIndent('left')"><i class="fas fa-outdent"></i> +0.5cm</button>
<button onclick="applyIndent('right')"><i class="fas fa-indent"></i> -0.5cm</button>
</div>

<!-- Botões de cores -->
<div class="color-bar">
<button onclick="applyColor('black')"><i class="fas fa-paint-brush" style="color: black;"></i> Preto</button> 
<button id="botaoAzulT" onclick="applyColor('blue')"><i class="fas fa-paint-brush" style="color: blue;"></i> Azul T</button>
<button onclick="applyColor('#800000')"><i class="fas fa-paint-brush" style="color: #800000;"></i> Marom B</button>
<button onclick="applyColor('red')"><i class="fas fa-paint-brush" style="color: red;"></i> Vermelho</button>
</div>

</div>

<!-- Editor de Texto (com contenteditable) -->
<div id="inputText" class="editor" contenteditable="true" placeholder="Digite ou cole seu texto aqui..."></div>

<div class="button-container">
<button onclick="convertToHTML()"> ↓ Converter ↓</button>
<button onclick="clearText()" class="clear-button">Limpar Tudo</button>
</div>

<div class="output-container">
<div class="code-output" id="codeOutput">O código fonte será exibido aqui.</div>
</div>

<div class="button-container">
<button onclick="copyHTML()">Copiar HTML</button>
</div>

<h3>
<p> DESENVOLVIMENTO - COORDENADORIA DE PLANEJAMENTO ADMINISTRATIVO</p>
</h3>
</div>

<!-- Sidebar do Manual -->
<div id="manualSidebar" class="sidebar">
  <div class="sidebar-header">
    <h3 class="sidebar-title">Manual de Instruções</h3>
    <span class="close-sidebar" onclick="toggleManual()">&times;</span>
  </div>
  <div id="manualContent">
    <h1>Passo a Passo</h1>
    
    <h2>Preparação do Documento</h2>
    <ol>
      <li class="step-highlight">Clique na área de edição (retângulo branco).</li>
      <li class="step-highlight">Clique no botão "Inserir Cabeçalho".</li>
    </ol>
    
    <h2>Importação do Texto</h2>
    <ol start="3">
      <li>Abra o arquivo .doc do ato normativo.</li>
      <li>Copie todo o conteúdo, desde o título do ato até o cargo da autoridade emitente.</li>
      <li>Cole o texto logo abaixo do cabeçalho inserido.</li>
    </ol>
    
    <h2>Formatação do Título</h2>
    <ol start="6">
      <li class="step-highlight">Selecione com o mouse o título completo do ato normativo.</li>
      <li class="step-highlight">Clique no botão de hiperlink (ícone de corrente) e insira o link do PDF do ato (portal de documentos).</li>
      <li class="step-highlight">Com o título ainda selecionado, clique no botão "B" para aplicar negrito.</li>
    </ol>
    
    <h2>Formatação da Ementa</h2>
    <ol start="9">
      <li class="step-highlight">Selecione todo o texto da ementa (abaixo do título).</li>
      <li class="step-highlight">Clique no botão "Padrão Ementa".</li>
    </ol>
    
    <h2>Inserção de Hiperlinks</h2>
    <ol start="11">
      <li>Identifique todas as citações de atos normativos no texto.</li>
      <li>Para cada ato normativo citado:
        <ul>
          <li class="step-highlight">Selecione o texto contendo a referencia do ato normativo, iniciando no tipo do ato e terminando no ano de sua produção (ex. Portaria n° 156, de 12 de março de 2014).</li>
          <li>Localize o link oficial do ato no google ou portais internos da UFSM.</li>
          <li class="step-highlight">Clique no botão de hiperlink e insira o link.</li>
        </ul>
      </li>
      <li>Para o número do processo UFSM:
        <ul>
          <li class="step-highlight">Selecione apenas o código numérico.</li>
          <li class="step-highlight">Clique no botão de hiperlink e insira o link do processo que originou o ato.</li>
        </ul>
      </li>
    </ol>
    
    <h2>Adição do Rodapé</h2>
    <ol start="14">
      <li class="step-highlight">Posicione o cursor após a o cargo da autoridade emitente e pressione Enter.</li>
      <li class="step-highlight">Clique no botão "Rodapé" e insira o mesmo link usado no título (portal de documentos).</li>
    </ol>
    
    <h2>Finalização</h2>
    <ol start="16">
      <li class="step-highlight">Clique no botão "Converter".</li>
      <li class="step-highlight">Clique em "Copiar HTML".</li>
      <li>Salve o código em um arquivo .txt para referência futura.</li>
      <li>Insira o HTML copiado no Elementor como código HTML.</li>
    </ol>
    
    <h2>Observações Importantes</h2>
    <ul>
      <li>Verifique se todos os hiperlinks estão funcionando antes de publicar.</li>
      <li>Confirme se a formatação foi mantida após a conversão.</li>
    </ul>
  </div>
</div>

<script>
let indentLevel = 0; 

function applyAlignment(alignment) {
const editor = document.getElementById('inputText');
document.execCommand('justify' + alignment);
}

function applyTag(tag) {
const editor = document.getElementById('inputText');
if (tag === 'link') {
const url = prompt("Digite a URL:");
if (url && url.trim() !== "") {
    const selection = window.getSelection();
    const range = selection.getRangeAt(0);
    const selectedText = selection.toString();
    // Usando atributos inline mais fortes para o Elementor
    const linkHTML = `<a href="${url}" style="color: blue !important; text-decoration: underline !important;" data-elementor-preserved="true">${selectedText}</a>`;
    range.deleteContents();
    range.insertNode(document.createRange().createContextualFragment(linkHTML));
}
} else {
document.execCommand(tag);
}
}

function applyIndent(direction) {
const editor = document.getElementById('inputText');
if (direction === 'left') {
document.execCommand('outdent');
indentLevel--; 
} else {
document.execCommand('indent');
indentLevel++; 
}
}

function applyEmenta() {
  const selectedText = window.getSelection().toString();

  if (selectedText.trim() === "") return;

  const range = window.getSelection().getRangeAt(0);

  const ementaHTML = `
    <div style="
      color: #800000;
      display: block;
      width: 60%;
      margin-left: auto;
      margin-right: 0;
      text-align: justify;
      font-weight: normal;">
      ${selectedText}
    </div>`;

  range.deleteContents();
  range.insertNode(document.createRange().createContextualFragment(ementaHTML));
}


function insertCabecalho() {
const editor = document.getElementById('inputText');
const imgTag = '<div align="center"><img src="https://www.ufsm.br/pro-reitorias/proplan/wp-content/uploads/sites/344/2019/09/brasao-da-republica-do-brasil-logo.png" alt="Brasão República Federativa do Brasil" width="6%" height="6%"></div>';
const texto1 = '<h4><font color="blue"><font size="5"><div align="center">MINISTÉRIO DA EDUCAÇÃO</font></font></div></h4>';
const texto2 = '<p><b><font color="0000blue"><div align="center">UNIVERSIDADE FEDERAL DE SANTA MARIA</font></b></div></p>';
const texto3 = '<br><div class="normal-text" style="color: black; text-align: center;"></div>';
const texto4 = '<div class="normal-text" style="text-align: center;"></div>';

document.execCommand('insertHTML', false, imgTag + texto1 + texto2 + texto3 + texto4);
}

function formatHTML(html) { 
let formatted = '';
let reg = /(>)(<)(\/*)/g;
let xml = html.replace(reg, '$1\r\n$2$3'); 
xml.split('\r\n').forEach(function(node) {
    formatted += node + '\r\n';
});

return formatted.trim(); 
}

function convertToHTML() {
  const editor = document.getElementById('inputText');
  const output = document.getElementById('codeOutput');
  let htmlContent = editor.innerHTML;

  // 🔥 Remove lixo do MS Word (VML, mso, comentários condicionais, namespaces)
  htmlContent = htmlContent
    .replace(/<!--\[if.*?endif\]-->/gis, '')                             // Comentários condicionais
    .replace(/<style[^>]*>[\s\S]*?<\/style>/gi, '')                     // <style> com mso e VML
    .replace(/<(\/)?(o|w|v):[^>]*>/gi, '')                              // Tags com prefixo o:, w:, v:
    .replace(/\sstyle="[^"]*mso-[^"]*"/gi, '')                          // Inline com mso-*
    .replace(/\sclass="Mso[a-zA-Z0-9]*"/gi, '')                         // Classes do Word
    .replace(/\sxmlns(:\w+)?="[^"]*"/gi, '');                           // Namespaces do Word

  // Formata o HTML antes de exibir
  let formattedHTML = formatHTML(htmlContent);

  // Força estilo dos links (Elementor)
  formattedHTML = formattedHTML.replace(
    /<a\s+href="([^"]+)"([^>]*)>/g,
    '<a href="$1" style="color: blue !important; text-decoration: underline !important;" data-elementor-preserved="true"$2>'
  );

  // 🔁 Envolve tudo no bloco com <br><div align="justify"><font color="black">
  const finalHTML = `<br><div align="justify"><font color="black">\n${formattedHTML}\n</font></div>`;

  output.textContent = finalHTML;
}



function clearText() {
const editor = document.getElementById('inputText');
editor.innerHTML = '';
}

function copyHTML() {
const output = document.getElementById('codeOutput');
navigator.clipboard.writeText(output.textContent).then(() => {
alert("HTML copiado para a área de transferência!");
});
}

function applyColor(color) {
const editor = document.getElementById('inputText');
document.execCommand('foreColor', false, color);
}

function insertRodape() {
const editor = document.getElementById('inputText');
const url = prompt("Digite o link do Portal de Documentos:");
let rodapeTexto;
if (url && url.trim() !== "") {
    // Usando atributos mais fortes para o Elementor
    rodapeTexto = `<p><span style="color: red;">Este texto não substitui o documento original, publicado no Portal de Documentos.</span> Disponível em <a href="${url}" style="color: blue !important; text-decoration: underline !important;" data-elementor-preserved="true">${url}</a></p>`;
} else {
    rodapeTexto = `<p><span style="color: red;">Este texto não substitui o documento original, publicado no Portal de Documentos.</span> Disponível em: [Link não informado]</p>`;
}
document.execCommand('insertHTML', false, rodapeTexto);
}

// Preservar formatação ao colar, mas forçar justificado
document.getElementById('inputText').addEventListener('paste', function(e) {
  e.preventDefault();
  
  const html = e.clipboardData.getData('text/html') || e.clipboardData.getData('text/plain');

  const tempDiv = document.createElement('div');
  tempDiv.innerHTML = html;

  // Limpa estilos do Word e aplica justificado
  const elements = tempDiv.querySelectorAll('*');
  elements.forEach(el => {
    el.removeAttribute('style');
    el.removeAttribute('class');
    el.style.textAlign = 'justify';
  });

  document.execCommand('insertHTML', false, tempDiv.innerHTML);
});



// Função para alternar a visibilidade do manual
function toggleManual() {
    const sidebar = document.getElementById('manualSidebar');
    const mainContainer = document.getElementById('mainContainer');
    
    sidebar.classList.toggle('active');
    
    // Ajusta o espaço principal quando o sidebar está visível
    if (sidebar.classList.contains('active')) {
        mainContainer.classList.add('with-sidebar');
    } else {
        mainContainer.classList.remove('with-sidebar');
    }
}
</script>

</body>
</html>
